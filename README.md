# Детекция человека в видео
Приложение для анализа видеоконтента с целью обнаружения присутствия человека. Кадры с человеком сохраняются в итоговое видео, а кадры без человека — в отдельные видеофрагменты. Реализован удобный веб-интерфейс для загрузки видео, настройки параметров и просмотра результатов.
## Основные возможности

- **Разделение кадров**: Автоматическое сохранение кадров с человеком в итоговое видео и кадров без человека в отдельные фрагменты.
- **Фильтрация по размерам объекта**: Настройка минимальной и максимальной ширины/высоты для точной детекции человека.
- **Визуализация удалённых кадров**: Опция отображения кадров без человека для просмотра.
- **График уверенности**: Построение графика уверенности детекции человека по кадрам с использованием Chart.js.
- **Веб-интерфейс**: Удобная загрузка видео, настройка параметров и просмотр результатов в браузере.

## Установка
```bash
# Клонируем репозиторий
git clone https://git.miem.hse.ru/kg25-26/aaviktorov.git
# Устанавливаем зависимости
pip install -r requirements.txt
```
## Использование

### Запуск через Python

```bash
python app.py
```

После запуска откройте браузер и перейдите по адресу `http://localhost:5000` для работы с веб-интерфейсом.

### Параметры веб-интерфейса

| Параметр | Описание |
|----------|----------|
| `Минимальная ширина объекта` | Минимальная ширина человека в пикселях |
| `Максимальная ширина объекта` | Максимальная ширина человека в пикселях |
| `Минимальная высота объекта` | Минимальная высота человека в пикселях |
| `Максимальная высота объекта` | Максимальная высота человека в пикселях |
| `Визуализировать удалённые кадры` | Включение отображения кадров без человека |
### Использование Docker

#### Сборка образа

```bash
docker build -t human-detector-app .
```
#### Запуск контейнера

```bash
docker run -p 5000:5000 human-detector-app
```

После запуска веб-интерфейс доступен по адресу `http://localhost:5000`.

### Запуск через Docker Compose 
```bash
docker-compose up --build
```
После запуска веб-интерфейс будет доступен по адресу `http://localhost:5000`

#### Выполнение команд в контейнере

```bash
# Просмотр справки
docker run --rm human-detector-app python app.py --help
```

## Частые проблемы

**Порт 5000 занят**:

Попробуйте использовать другой порт:

```bash
docker run -p 8080:5000 human-detector-app
```
**Контейнер не запускается**:

Проверьте логи для диагностики:

```bash
docker ps
docker logs <container_id>
```

## Рекомендации

- **Размер видео**: Не загружайте видео больше 500 МБ, чтобы избежать проблем с веб-интерфейсом.
- **Настройка параметров**: Протестируйте приложение на коротком видео, чтобы подобрать оптимальные значения ширины и высоты.
- **Визуализация**: Включение отображения удалённых кадров увеличивает время обработки.
- **Обновление страницы**: Перед загрузкой нового видео обновите страницу в браузере, чтобы избежать конфликтов.
## Техническая информация

- **Модель детекции**: Используется YOLOv8 для обнаружения человека.
- **Выходные данные**:
  - Итоговое видео с кадрами, где присутствует человек.
  - Отдельные видеофрагменты с кадрами без человека.
- **Визуализация**: График уверенности строится с использованием Chart.js.
- **Зависимости**:
  - Flask для веб-интерфейса.
  - OpenCV для обработки видео.
  - Ultralytics YOLO для детекции человека.
  - PyTorch для работы модели.
  - NumPy для числовых операций.

## Советы

- Начните с коротких видео для настройки параметров детекции.
- Используйте разумные значения ширины и высоты для баланса между точностью и скоростью обработки.
- Веб-интерфейс предпочтителен для пользователей без технического опыта.

*При разработке использовались инструменты искусственного интеллекта(https://chatgpt.com/?model=auto) для того,  чтобы узнать, что лучше использовать, для быстрого изучения библиотек ,оптимизации кода и создания стилей CSS/JavaScript для улучшения пользовательского интерфейса.*